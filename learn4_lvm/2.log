Script started on Mon 03 Jan 2022 02:30:07 PM UTC
[vagrant@lvm ~]$ sudo bash
[root@lvm vagrant]# lsblk
NAME              MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda                 8:0    0   40G  0 disk
├─sda1              8:1    0    1G  0 part /boot
└─sda2              8:2    0    9G  0 part
  ├─centos-swap   253:1    0    1G  0 lvm  [SWAP]
  └─centos-root   253:2    0    8G  0 lvm
sdb                 8:16   0  9.8G  0 disk
└─vg_root-lv_root 253:0    0  9.8G  0 lvm  /
sdc                 8:32   0    2G  0 disk
sdd                 8:48   0    1G  0 disk
sde                 8:64   0    1G  0 disk
[root@lvm vagrant]# lvremove /dev/centos/root
Do you really want to remove active logical volume centos/root? [y/n]: y
  WARNING: Invalid input 'y'.
Do you really want to remove active logical volume centos/root? [y/n]: y
  Logical volume "root" successfully removed
[root@lvm vagrant]# lvcreate -n centos/root -L 6G /dev/centos
WARNING: xfs signature detected on /dev/centos/root at offset 0. Wipe it? [y/n]: y
  Wiping xfs signature on /dev/centos/root.
  Logical volume "root" created.
[root@lvm vagrant]# mkfs.xfs /dev/centos/root
meta-data=/dev/centos/root       isize=512    agcount=4, agsize=393216 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=1        finobt=0, sparse=0
data     =                       bsize=4096   blocks=1572864, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal log           bsize=4096   blocks=2560, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
[root@lvm vagrant]# mount /dev/centos/root /mnt
[root@lvm vagrant]# xfsdump -J - /dev/vg_root/lv_root | xfsrestore -J - /mnt
xfsdump: xfsrestore: using file dump (drive_simple) strategy
using file dump (drive_simple) strategy
xfsrestore: version 3.1.7 (dump format 3.0)xfsdump:
version 3.1.7 (dump format 3.0)
xfsdump: level 0 dump of lvm:/
xfsdump: dump date: Mon Jan  3 14:31:18 2022
xfsdump: session id: 0cc5910d-ac62-42f7-9fda-79d7a3015bba
xfsdump: session label: ""
xfsrestore: searching media for dump
xfsdump: ino map phase 1: constructing initial dump list
xfsdump: ino map phase 2: skipping (no pruning necessary)
xfsdump: ino map phase 3: skipping (only one dump stream)
xfsdump: ino map construction complete
xfsdump: estimated dump size: 1853284288 bytes
xfsdump: creating dump session media file 0 (media 0, file 0)
xfsdump: dumping ino map
xfsdump: dumping directories
xfsrestore: examining media file 0
xfsrestore: dump description:
xfsrestore: hostname: lvm
xfsrestore: mount point: /
xfsrestore: volume: /dev/mapper/vg_root-lv_root
xfsrestore: session time: Mon Jan  3 14:31:18 2022
xfsrestore: level: 0
xfsrestore: session label: ""
xfsrestore: media label: ""
xfsrestore: file system id: 05b9e099-96c5-4831-b23d-9f03c1dec362
xfsrestore: session id: 0cc5910d-ac62-42f7-9fda-79d7a3015bba
xfsrestore: media id: 9a65902f-9b35-4c66-afa1-aa96b0216669
xfsrestore: searching media for directory dump
xfsrestore: reading directories
xfsdump: dumping non-directory files
xfsrestore: 5909 directories and 42663 entries processed
xfsrestore: directory post-processing
xfsrestore: restoring non-directory files
xfsdump: ending media file
xfsdump: media file size 1810088704 bytes
xfsdump: dump size (non-dir files) : 1787025232 bytes
xfsdump: dump complete: 6 seconds elapsed
xfsdump: Dump Status: SUCCESS
xfsrestore: restore complete: 6 seconds elapsed
xfsrestore: Restore Status: SUCCESS
[root@lvm vagrant]# for i in /proc/ /sys/ /dev/ /run/ /boot/; do mount --bind $i /mnt/$i; done
[root@lvm vagrant]# chroot /mnt/
[root@lvm /]#  grub2-mkconfig -o /boot/grub2/grub.cfg
Generating grub configuration file ...
Found linux image: /boot/vmlinuz-5.15.11-1.el7.elrepo.x86_64
Found initrd image: /boot/initramfs-5.15.11-1.el7.elrepo.x86_64.img
Found linux image: /boot/vmlinuz-3.10.0-1160.49.1.el7.x86_64
Found initrd image: /boot/initramfs-3.10.0-1160.49.1.el7.x86_64.img
Found linux image: /boot/vmlinuz-0-rescue-141012819d85a14a99b1cadab92ce764
Found initrd image: /boot/initramfs-0-rescue-141012819d85a14a99b1cadab92ce764.img
done
[root@lvm /]#  cd /boot ; for i in `ls initramfs-*img`; do dracut -v $i `echo $i|sed "s/initramfs-//g;s/.img//g"` --force; done
Kernel version 0-rescue-141012819d85a14a99b1cadab92ce764 has no module directory /lib/modules/0-rescue-141012819d85a14a99b1cadab92ce764
Executing: /sbin/dracut -v initramfs-0-rescue-141012819d85a14a99b1cadab92ce764.img 0-rescue-141012819d85a14a99b1cadab92ce764 --force
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
*** Including module: bash ***
*** Including module: nss-softokn ***
*** Including module: i18n ***
*** Including module: network ***
*** Including module: ifcfg ***
*** Including module: drm ***
*** Including module: plymouth ***
*** Including module: dm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 60-persistent-storage-dm.rules
Skipping udev rule: 55-dm.rules
*** Including module: kernel-modules ***
*** Including module: lvm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 56-lvm.rules
Skipping udev rule: 60-persistent-storage-lvm.rules
*** Including module: qemu ***
*** Including module: resume ***
*** Including module: rootfs-block ***
*** Including module: terminfo ***
*** Including module: udev-rules ***
Skipping udev rule: 40-redhat-cpu-hotplug.rules
Skipping udev rule: 91-permissions.rules
*** Including module: biosdevname ***
*** Including module: systemd ***
*** Including module: usrmount ***
*** Including module: base ***
*** Including module: fs-lib ***
*** Including module: microcode_ctl-fw_dir_override ***
  microcode_ctl module: mangling fw_dir
    microcode_ctl: reset fw_dir to "/lib/firmware/updates /lib/firmware"
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel"...
intel: model '', path ' intel-ucode/*', kvers ''
No matching microcode files in ' intel-ucode/*' for CPU model 'AuthenticAMD 19-21-00', skipping
    microcode_ctl: configuration "intel" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-2d-07"...
intel-06-2d-07: model 'GenuineIntel 06-2d-07', path ' intel-ucode/06-2d-07', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-2d-07', skipping
    microcode_ctl: configuration "intel-06-2d-07" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4e-03"...
intel-06-4e-03: model 'GenuineIntel 06-4e-03', path ' intel-ucode/06-4e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4e-03', skipping
    microcode_ctl: configuration "intel-06-4e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4f-01"...
intel-06-4f-01: model 'GenuineIntel 06-4f-01', path ' intel-ucode/06-4f-01', kvers ' 4.17.0 3.10.0-894 3.10.0-862.6.1 3.10.0-693.35.1 3.10
.0-514.52.1 3.10.0-327.70.1 2.6.32-754.1.1 2.6.32-573.58.1 2.6.32-504.71.1 2.6.32-431.90.1 2.6.32-358.90.1'
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4f-01', skipping
    microcode_ctl: configuration "intel-06-4f-01" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-55-04"...
intel-06-55-04: model 'GenuineIntel 06-55-04', path ' intel-ucode/06-55-04', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-55-04', skipping
    microcode_ctl: configuration "intel-06-55-04" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-5e-03"...
intel-06-5e-03: model 'GenuineIntel 06-5e-03', path ' intel-ucode/06-5e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-5e-03', skipping
    microcode_ctl: configuration "intel-06-5e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8c-01"...
intel-06-8c-01: model 'GenuineIntel 06-8c-01', path ' intel-ucode/06-8c-01', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-8c-01', skipping
    microcode_ctl: configuration "intel-06-8c-01" is ignored
    microcode_ctl: final fw_dir: "/lib/firmware/updates /lib/firmware"
*** Including module: shutdown ***
*** Including modules done ***
*** Installing kernel module dependencies and firmware ***
*** Installing kernel module dependencies and firmware done ***
*** Resolving executable dependencies ***
*** Resolving executable dependencies done***
*** Hardlinking files ***
*** Hardlinking files done ***
*** Stripping files ***
*** Stripping files done ***
*** Generating early-microcode cpio image contents ***
*** Constructing AuthenticAMD.bin ****
*** No early-microcode cpio image needed ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-0-rescue-141012819d85a14a99b1cadab92ce764.img' done ***
Executing: /sbin/dracut -v initramfs-3.10.0-1160.49.1.el7.x86_64.img 3.10.0-1160.49.1.el7.x86_64 --force
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
*** Including module: bash ***
*** Including module: nss-softokn ***
*** Including module: i18n ***
*** Including module: network ***
*** Including module: ifcfg ***
*** Including module: drm ***
*** Including module: plymouth ***
*** Including module: dm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 60-persistent-storage-dm.rules
Skipping udev rule: 55-dm.rules
*** Including module: kernel-modules ***
*** Including module: lvm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 56-lvm.rules
Skipping udev rule: 60-persistent-storage-lvm.rules
*** Including module: qemu ***
*** Including module: resume ***
*** Including module: rootfs-block ***
*** Including module: terminfo ***
*** Including module: udev-rules ***
Skipping udev rule: 40-redhat-cpu-hotplug.rules
Skipping udev rule: 91-permissions.rules
*** Including module: biosdevname ***
*** Including module: systemd ***
*** Including module: usrmount ***
*** Including module: base ***
*** Including module: fs-lib ***
*** Including module: microcode_ctl-fw_dir_override ***
  microcode_ctl module: mangling fw_dir
    microcode_ctl: reset fw_dir to "/lib/firmware/updates /lib/firmware"
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel"...
intel: model '', path ' intel-ucode/*', kvers ''
No matching microcode files in ' intel-ucode/*' for CPU model 'AuthenticAMD 19-21-00', skipping
    microcode_ctl: configuration "intel" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-2d-07"...
intel-06-2d-07: model 'GenuineIntel 06-2d-07', path ' intel-ucode/06-2d-07', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-2d-07', skipping
    microcode_ctl: configuration "intel-06-2d-07" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4e-03"...
intel-06-4e-03: model 'GenuineIntel 06-4e-03', path ' intel-ucode/06-4e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4e-03', skipping
    microcode_ctl: configuration "intel-06-4e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4f-01"...
intel-06-4f-01: model 'GenuineIntel 06-4f-01', path ' intel-ucode/06-4f-01', kvers ' 4.17.0 3.10.0-894 3.10.0-862.6.1 3.10.0-693.35.1 3.10
.0-514.52.1 3.10.0-327.70.1 2.6.32-754.1.1 2.6.32-573.58.1 2.6.32-504.71.1 2.6.32-431.90.1 2.6.32-358.90.1'
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4f-01', skipping
    microcode_ctl: configuration "intel-06-4f-01" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-55-04"...
intel-06-55-04: model 'GenuineIntel 06-55-04', path ' intel-ucode/06-55-04', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-55-04', skipping
    microcode_ctl: configuration "intel-06-55-04" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-5e-03"...
intel-06-5e-03: model 'GenuineIntel 06-5e-03', path ' intel-ucode/06-5e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-5e-03', skipping
    microcode_ctl: configuration "intel-06-5e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8c-01"...
intel-06-8c-01: model 'GenuineIntel 06-8c-01', path ' intel-ucode/06-8c-01', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-8c-01', skipping
    microcode_ctl: configuration "intel-06-8c-01" is ignored
    microcode_ctl: final fw_dir: "/lib/firmware/updates /lib/firmware"
*** Including module: shutdown ***
*** Including modules done ***
*** Installing kernel module dependencies and firmware ***
*** Installing kernel module dependencies and firmware done ***
*** Resolving executable dependencies ***
*** Resolving executable dependencies done***
*** Hardlinking files ***
*** Hardlinking files done ***
*** Stripping files ***
*** Stripping files done ***
*** Generating early-microcode cpio image contents ***
*** Constructing AuthenticAMD.bin ****
*** No early-microcode cpio image needed ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-3.10.0-1160.49.1.el7.x86_64.img' done ***
Kernel version 3.10.0-1160.49.1.el7.x86_64kdump has no module directory /lib/modules/3.10.0-1160.49.1.el7.x86_64kdump
Executing: /sbin/dracut -v initramfs-3.10.0-1160.49.1.el7.x86_64kdump.img 3.10.0-1160.49.1.el7.x86_64kdump --force
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
*** Including module: bash ***
*** Including module: nss-softokn ***
*** Including module: i18n ***
*** Including module: network ***
*** Including module: ifcfg ***
*** Including module: drm ***
*** Including module: plymouth ***
*** Including module: dm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 60-persistent-storage-dm.rules
Skipping udev rule: 55-dm.rules
*** Including module: kernel-modules ***
*** Including module: lvm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 56-lvm.rules
Skipping udev rule: 60-persistent-storage-lvm.rules
*** Including module: qemu ***
*** Including module: resume ***
*** Including module: rootfs-block ***
*** Including module: terminfo ***
*** Including module: udev-rules ***
Skipping udev rule: 40-redhat-cpu-hotplug.rules
Skipping udev rule: 91-permissions.rules
*** Including module: biosdevname ***
*** Including module: systemd ***
*** Including module: usrmount ***
*** Including module: base ***
*** Including module: fs-lib ***
*** Including module: microcode_ctl-fw_dir_override ***
  microcode_ctl module: mangling fw_dir
    microcode_ctl: reset fw_dir to "/lib/firmware/updates /lib/firmware"
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel"...
intel: model '', path ' intel-ucode/*', kvers ''
No matching microcode files in ' intel-ucode/*' for CPU model 'AuthenticAMD 19-21-00', skipping
    microcode_ctl: configuration "intel" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-2d-07"...
intel-06-2d-07: model 'GenuineIntel 06-2d-07', path ' intel-ucode/06-2d-07', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-2d-07', skipping
    microcode_ctl: configuration "intel-06-2d-07" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4e-03"...
intel-06-4e-03: model 'GenuineIntel 06-4e-03', path ' intel-ucode/06-4e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4e-03', skipping
    microcode_ctl: configuration "intel-06-4e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4f-01"...
intel-06-4f-01: model 'GenuineIntel 06-4f-01', path ' intel-ucode/06-4f-01', kvers ' 4.17.0 3.10.0-894 3.10.0-862.6.1 3.10.0-693.35.1 3.10
.0-514.52.1 3.10.0-327.70.1 2.6.32-754.1.1 2.6.32-573.58.1 2.6.32-504.71.1 2.6.32-431.90.1 2.6.32-358.90.1'
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4f-01', skipping
    microcode_ctl: configuration "intel-06-4f-01" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-55-04"...
intel-06-55-04: model 'GenuineIntel 06-55-04', path ' intel-ucode/06-55-04', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-55-04', skipping
    microcode_ctl: configuration "intel-06-55-04" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-5e-03"...
intel-06-5e-03: model 'GenuineIntel 06-5e-03', path ' intel-ucode/06-5e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-5e-03', skipping
    microcode_ctl: configuration "intel-06-5e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8c-01"...
intel-06-8c-01: model 'GenuineIntel 06-8c-01', path ' intel-ucode/06-8c-01', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-8c-01', skipping
    microcode_ctl: configuration "intel-06-8c-01" is ignored
    microcode_ctl: final fw_dir: "/lib/firmware/updates /lib/firmware"
*** Including module: shutdown ***
*** Including modules done ***
*** Installing kernel module dependencies and firmware ***
*** Installing kernel module dependencies and firmware done ***
*** Resolving executable dependencies ***
*** Resolving executable dependencies done***
*** Hardlinking files ***
*** Hardlinking files done ***
*** Stripping files ***
*** Stripping files done ***
*** Generating early-microcode cpio image contents ***
*** Constructing AuthenticAMD.bin ****
*** No early-microcode cpio image needed ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-3.10.0-1160.49.1.el7.x86_64kdump.img' done ***
Executing: /sbin/dracut -v initramfs-5.15.11-1.el7.elrepo.x86_64.img 5.15.11-1.el7.elrepo.x86_64 --force
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
dracut module 'modsign' will not be installed, because command 'keyctl' could not be found!
dracut module 'busybox' will not be installed, because command 'busybox' could not be found!
dracut module 'crypt' will not be installed, because command 'cryptsetup' could not be found!
dracut module 'dmraid' will not be installed, because command 'dmraid' could not be found!
dracut module 'dmsquash-live-ntfs' will not be installed, because command 'ntfs-3g' could not be found!
dracut module 'mdraid' will not be installed, because command 'mdadm' could not be found!
dracut module 'multipath' will not be installed, because command 'multipath' could not be found!
dracut module 'cifs' will not be installed, because command 'mount.cifs' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsistart' could not be found!
dracut module 'iscsi' will not be installed, because command 'iscsi-iname' could not be found!
95nfs: Could not find any command of 'rpcbind portmap'!
*** Including module: bash ***
*** Including module: nss-softokn ***
*** Including module: i18n ***
*** Including module: network ***
*** Including module: ifcfg ***
*** Including module: drm ***
*** Including module: plymouth ***
*** Including module: dm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 60-persistent-storage-dm.rules
        else
Skipping udev rule: 55-dm.rules
*** Including module: kernel-modules ***
*** Including module: lvm ***
Skipping udev rule: 64-device-mapper.rules
Skipping udev rule: 56-lvm.rules
Skipping udev rule: 60-persistent-storage-lvm.rules
*** Including module: qemu ***
*** Including module: resume ***
*** Including module: rootfs-block ***
*** Including module: terminfo ***
*** Including module: udev-rules ***
Skipping udev rule: 40-redhat-cpu-hotplug.rules
Skipping udev rule: 91-permissions.rules
*** Including module: biosdevname ***
*** Including module: systemd ***
*** Including module: usrmount ***
*** Including module: base ***
*** Including module: fs-lib ***
*** Including module: microcode_ctl-fw_dir_override ***
  microcode_ctl module: mangling fw_dir
    microcode_ctl: reset fw_dir to "/lib/firmware/updates /lib/firmware"
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel"...
intel: model '', path ' intel-ucode/*', kvers ''
No matching microcode files in ' intel-ucode/*' for CPU model 'AuthenticAMD 19-21-00', skipping
    microcode_ctl: configuration "intel" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-2d-07"...
intel-06-2d-07: model 'GenuineIntel 06-2d-07', path ' intel-ucode/06-2d-07', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-2d-07', skipping
    microcode_ctl: configuration "intel-06-2d-07" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4e-03"...
intel-06-4e-03: model 'GenuineIntel 06-4e-03', path ' intel-ucode/06-4e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4e-03', skipping
    microcode_ctl: configuration "intel-06-4e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-4f-01"...
intel-06-4f-01: model 'GenuineIntel 06-4f-01', path ' intel-ucode/06-4f-01', kvers ' 4.17.0 3.10.0-894 3.10.0-862.6.1 3.10.0-693.35.1 3.10
.0-514.52.1 3.10.0-327.70.1 2.6.32-754.1.1 2.6.32-573.58.1 2.6.32-504.71.1 2.6.32-431.90.1 2.6.32-358.90.1'
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-4f-01', skipping
    microcode_ctl: configuration "intel-06-4f-01" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-55-04"...
intel-06-55-04: model 'GenuineIntel 06-55-04', path ' intel-ucode/06-55-04', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-55-04', skipping
    microcode_ctl: configuration "intel-06-55-04" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-5e-03"...
intel-06-5e-03: model 'GenuineIntel 06-5e-03', path ' intel-ucode/06-5e-03', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-5e-03', skipping
    microcode_ctl: configuration "intel-06-5e-03" is ignored
    microcode_ctl: processing data directory  "/usr/share/microcode_ctl/ucode_with_caveats/intel-06-8c-01"...
intel-06-8c-01: model 'GenuineIntel 06-8c-01', path ' intel-ucode/06-8c-01', kvers ''
Current CPU model 'AuthenticAMD 19-21-00' doesn't match configuration CPU model 'GenuineIntel 06-8c-01', skipping
    microcode_ctl: configuration "intel-06-8c-01" is ignored
    microcode_ctl: final fw_dir: "/lib/firmware/updates /lib/firmware"
*** Including module: shutdown ***
*** Including modules done ***
*** Installing kernel module dependencies and firmware ***
*** Installing kernel module dependencies and firmware done ***
*** Resolving executable dependencies ***
*** Resolving executable dependencies done***
*** Hardlinking files ***
*** Hardlinking files done ***
*** Stripping files ***
*** Stripping files done ***
*** Generating early-microcode cpio image contents ***
*** Constructing AuthenticAMD.bin ****
*** No early-microcode cpio image needed ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-5.15.11-1.el7.elrepo.x86_64.img' done ***
[root@lvm boot]# vim /boot/grub2/grub.cfg
[root@lvm boot]# pvcreate /dev/sdc /dev/sdd
  Physical volume "/dev/sdc" successfully created.
  Physical volume "/dev/sdd" successfully created.
[root@lvm boot]# vgcreate vg_rootvar /dev/sdc /dev/sd
  Device /dev/sd not found.
[root@lvm boot]# vgcreate vg_rootvar /dev/sdc /dev/sdd
  Volume group "vg_rootvar" successfully created
[root@lvm boot]# lvcreate -L 950M -m1 -n lv_rootvar vg_rootvar
  Rounding up size to full physical extent 952.00 MiB
  Logical volume "lv_rootvar" created.
[root@lvm boot]# mkfs.ext4 /dev/vg_rootvar/lv_rootvar
mke2fs 1.42.9 (28-Dec-2013)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
Stride=0 blocks, Stripe width=0 blocks
60928 inodes, 243712 blocks
12185 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=249561088
8 block groups
32768 blocks per group, 32768 fragments per group
7616 inodes per group
Superblock backups stored on blocks:
        32768, 98304, 163840, 229376

Allocating group tables: done
Writing inode tables: done
Creating journal (4096 blocks): done
Writing superblocks and filesystem accounting information: done

[root@lvm boot]# ls -la /mnt/
total 0
drwxr-xr-x.  2 root root   6 Apr 11  2018 .
drwxr-xr-x. 18 root root 259 Jan  3 14:31 ..
[root@lvm boot]# mount /dev/vg_rootvar/lv_rootvar /mnt
[root@lvm boot]# cp -aR /var/* /mnt/
[root@lvm boot]# rsync -avHPSAX /var/ /mnt/
bash: rsync: command not found
[root@lvm boot]# yum install rsync
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.datahouse.ru
 * elrepo: mirror.yandex.ru
 * extras: mirror.reconn.ru
 * updates: mirrors.datahouse.ru
Resolving Dependencies
--> Running transaction check
---> Package rsync.x86_64 0:3.1.2-10.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

==========================================================================================================================================
 Package                        Arch                            Version                               Repository                     Size
==========================================================================================================================================
Installing:
 rsync                          x86_64                          3.1.2-10.el7                          base                          404 k

Transaction Summary
==========================================================================================================================================
Install  1 Package

Total download size: 404 k
Installed size: 815 k
Is this ok [y/d/N]: y
Downloading packages:
rsync-3.1.2-10.el7.x86_64.rpm                                                                                      | 404 kB  00:00:00
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : rsync-3.1.2-10.el7.x86_64                                                                                              1/1
  Verifying  : rsync-3.1.2-10.el7.x86_64                                                                                              1/1

Installed:
  rsync.x86_64 0:3.1.2-10.el7

Complete!
[root@lvm boot]# rsync -avHPSAX /var/ /mnt/
sending incremental file list
./
.updated
            163 100%    0.00kB/s    0:00:00 (xfr#1, ir-chk=1024/1026)
cache/yum/x86_64/7/
cache/yum/x86_64/7/timedhosts
             80 100%   78.12kB/s    0:00:00 (xfr#2, ir-chk=1006/1035)
cache/yum/x86_64/7/base/packages/
lib/rpm/
lib/rpm/Basenames
      1,740,800 100%   75.46MB/s    0:00:00 (xfr#3, ir-chk=1016/1131)
lib/rpm/Dirnames
        737,280 100%   27.04MB/s    0:00:00 (xfr#4, ir-chk=1014/1131)
lib/rpm/Group
          8,192 100%  307.69kB/s    0:00:00 (xfr#5, ir-chk=1013/1131)
lib/rpm/Installtid
         12,288 100%  461.54kB/s    0:00:00 (xfr#6, ir-chk=1012/1131)
lib/rpm/Name
         24,576 100%  923.08kB/s    0:00:00 (xfr#7, ir-chk=1011/1131)
lib/rpm/Packages
     98,525,184 100%  378.87MB/s    0:00:00 (xfr#8, ir-chk=1009/1131)
lib/rpm/Providename
      2,809,856 100%    9.21MB/s    0:00:00 (xfr#9, ir-chk=1008/1131)
lib/rpm/Requirename
        143,360 100%  428.13kB/s    0:00:00 (xfr#10, ir-chk=1007/1131)
lib/rpm/Sha1header
         40,960 100%  122.32kB/s    0:00:00 (xfr#11, ir-chk=1006/1131)
lib/rpm/Sigmd5
         28,672 100%   85.63kB/s    0:00:00 (xfr#12, ir-chk=1005/1131)
lib/rpm/__db.001
        442,368 100%    1.29MB/s    0:00:00 (xfr#13, ir-chk=1003/1131)
lib/rpm/__db.002
        106,496 100%  316.11kB/s    0:00:00 (xfr#14, ir-chk=1002/1131)
lib/rpm/__db.003
      1,318,912 100%    3.79MB/s    0:00:00 (xfr#15, ir-chk=1001/1131)
lib/yum/
lib/yum/history/history-2022-01-01.sqlite
        557,056 100%    1.60MB/s    0:00:00 (xfr#16, ir-chk=1002/1145)
lib/yum/history/history-2022-01-01.sqlite-journal
         22,184 100%   65.06kB/s    0:00:00 (xfr#17, ir-chk=1001/1145)
lib/yum/history/2022-01-01/
lib/yum/history/2022-01-01/6/
lib/yum/history/2022-01-01/6/config-main
          3,810 100%   11.17kB/s    0:00:00 (xfr#18, ir-chk=1002/1168)
lib/yum/history/2022-01-01/6/config-repos
         10,089 100%   29.59kB/s    0:00:00 (xfr#19, ir-chk=1001/1168)
lib/yum/history/2022-01-01/6/saved_tx
            237 100%    0.70kB/s    0:00:00 (xfr#20, ir-chk=1000/1168)
lib/yum/rpmdb-indexes/
lib/yum/rpmdb-indexes/conflicts
          2,140 100%    6.28kB/s    0:00:00 (xfr#21, ir-chk=1004/1181)
lib/yum/rpmdb-indexes/file-requires
         14,516 100%   42.57kB/s    0:00:00 (xfr#22, ir-chk=1003/1181)
lib/yum/rpmdb-indexes/obsoletes
          2,469 100%    7.24kB/s    0:00:00 (xfr#23, ir-chk=1002/1181)
lib/yum/rpmdb-indexes/pkgtups-checksums
         36,195 100%  106.15kB/s    0:00:00 (xfr#24, ir-chk=1001/1181)
lib/yum/rpmdb-indexes/version
             45 100%    0.13kB/s    0:00:00 (xfr#25, ir-chk=1000/1181)
lib/yum/yumdb/r/
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/checksum_data
             64 100%    0.17kB/s    0:00:00 (xfr#26, to-chk=603/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/checksum_type
              6 100%    0.02kB/s    0:00:00 (xfr#27, to-chk=602/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/command_line
             13 100%    0.03kB/s    0:00:00 (xfr#28, to-chk=601/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/from_repo
              4 100%    0.01kB/s    0:00:00 (xfr#29, to-chk=600/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/from_repo_revision
             10 100%    0.03kB/s    0:00:00 (xfr#30, to-chk=599/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/from_repo_timestamp
             10 100%    0.03kB/s    0:00:00 (xfr#31, to-chk=598/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/installed_by
              4 100%    0.01kB/s    0:00:00 (xfr#32, to-chk=597/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/origin_url
             92 100%    0.24kB/s    0:00:00 (xfr#33, to-chk=596/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/reason
              4 100%    0.01kB/s    0:00:00 (xfr#34, to-chk=595/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/releasever
              1 100%    0.00kB/s    0:00:00 (xfr#35, to-chk=594/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/var_contentdir
              6 100%    0.02kB/s    0:00:00 (xfr#36, to-chk=593/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/var_infra
              5 100%    0.01kB/s    0:00:00 (xfr#37, to-chk=592/4352)
lib/yum/yumdb/r/5e86826da9a304d6919bb712cca6ca2008ceeefc-rsync-3.1.2-10.el7-x86_64/var_uuid
             36 100%    0.10kB/s    0:00:00 (xfr#38, to-chk=591/4352)
log/yum.log
          9,004 100%   23.76kB/s    0:00:00 (xfr#39, to-chk=70/4352)
tmp/

sent 106,768,402 bytes  received 1,361 bytes  71,179,842.00 bytes/sec
total size is 240,313,610  speedup is 2.25
[root@lvm boot]# mkdir /tmp/oldvar && mv /var/* /tmp/oldvar
[root@lvm boot]# umount /mnt
[root@lvm boot]# mount /dev/vg_rootvar/lv_rootvar /var
[root@lvm boot]# echo "`blkid | grep var: | awk '{print $2}'` /var ext4 defaults 0 0" >> /etc/fstab
[root@lvm boot]# cat /etc/fstab

#
# /etc/fstab
# Created by anaconda on Sat Jan  1 21:51:37 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/centos-root /                       xfs     defaults        0 0
UUID=2442fd26-2f90-4437-bb83-2a48be2a1ba5 /boot                   xfs     defaults        0 0
/dev/mapper/centos-swap swap                    swap    defaults        0 0
UUID="1de3c38e-af21-480e-9a6f-a4fd5a1967a7" /var ext4 defaults 0 0
[root@lvm boot]# exit
exit
[root@lvm vagrant]# chroot /mnt/^C
[root@lvm vagrant]# exit
[vagrant@lvm ~]$ exit

Script done on Mon 03 Jan 2022 02:35:06 PM UTC
